"use strict";var crypto=require("crypto");exports.parseHeader=function(e){var r,t,a,n={},o=[],i=e.split(",");for(r=0;r<i.length;r+=1){for(o=i[r].split("="),a="",t=1;t<o.length;t+=1)""===o[t]?a+="=":a+=o[t];n[o[0].slice(6)]=a}return n},exports.makeHeader=function(e){if(void 0!==e.realm){var r,t='MAuth realm="'+e.realm+'"';for(r in e)e.hasOwnProperty(r)&&"realm"!==r&&(t+=",mauth_"+r+'="'+e[r]+'"');return t}},exports.calculateClientSignature=function(e,r){var t,a=e.timestamp+","+e.cnonce;return void 0!==e.username&&void 0!==e.role&&(a+=","+e.username+","+e.role),t=crypto.createHmac("sha256",r).update(a).digest("hex"),new Buffer(t).toString("base64")},exports.calculateServerSignature=function(e,r){var t=e.timestamp,a=crypto.createHmac("sha256",r).update(t).digest("hex");return new Buffer(a).toString("base64")};